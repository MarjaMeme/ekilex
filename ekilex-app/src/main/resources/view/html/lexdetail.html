<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head></head>
<body>
  <th:block th:fragment="lexeme_details_lite">
    <div class="px-3 pb-2 pt-2 border-bottom border-light">
      <div class="lexeme-inner" th:classappend="${lexeme.levels != null && lexeme.levels.length() == 3} ? 'pl-4': ''">
        <div class="d-flex flex-row flex-nowrap align-items-start">
          <span th:if="${lexeme.levels != null}"
                th:data-id="${lexeme.lexemeId}"
                th:data-level1="${lexeme.level1}"
                th:data-level2="${lexeme.level2}"
                class="px-2 py-0 bg-light rounded font-weight-bold mr-2"
                th:text="${lexeme.levels}"> </span>
          <div>
            <div class="d-flex flex-row flex-wrap" th:each="meaningWordLangGroup,meaningWordLangGroupIter : ${lexeme.meaningWordLangGroups}">
              <span th:if="${lexeme.wordLang == meaningWordLangGroup.lang}" class="mr-2" th:text="#{syn.abbreviation}"></span>
              <span th:unless="${lexeme.wordLang == meaningWordLangGroup.lang}" th:text="${viewUtil.getLangIso2(meaningWordLangGroup.lang)}" class="mr-2"></span>
              <span th:each="meaningWord,meaningWordIter : ${meaningWordLangGroup.meaningWords}">
                <span class="btn-custom">
                  <button
                    type="button"
                    class="btn btn-link p-0"
                    th:data-id="${meaningWord.wordId}"
                    name="details-btn"
                    data-plugin="contextmenu"
                    data-contextmenu:compare="Ava uues paneelis"
                    data-behaviour="replace">
                    <span th:utext="${viewUtil.getWordValueMarkup(meaningWord)}"></span>
                    <span th:text="${meaningWord.homonymNr}"></span>
                    <span th:text="${'[ ' + viewUtil.getFormattedLexemeWeight(meaningWord.lexemeWeight) + ' ]'}"></span>
                  </button>
                  <span th:unless="${meaningWordIter.last}">&nbsp;|&nbsp;</span>
                </span>
              </span>
            </div>
          </div>
          <div class="ml-auto d-flex flex-row align-items-center">
            <b th:text="${lexeme.datasetName}" class="mr-2"></b>
            <button type="button" name="lexeme-details-btn"
                    class="btn btn-secondary btn-sm btn-toggle" title="Näita detaile"
                    th:data-id="${lexeme.lexemeId}" th:data-lex-levels="${lexeme.levels}" th:data-composition="full">
              <i class="fa fa-angle-down" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <div class="d-flex flex-column">
          <div class="d-flex align-items-center flex-wrap">
            <div th:if="${not #lists.isEmpty(lexeme.meaning.definitions)}">
              <span th:utext="${lexeme.meaning.definitions.get(0).value}"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </th:block>
  <th:block th:fragment="lexeme_details_full">
    <div class="px-3 pb-2 mb-2 border-bottom border-light"
         th:with="
           isMeaningLexemeCrudGranted=${#vars.lexeme.meaning.subGrant},
           isMeaningAnyLexemeCrudGranted=${#vars.lexeme.meaning.anyGrant}">
      <div th:replace="lexdialog :: add_lexeme_data_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_tag_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_pos_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_deriv_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_register_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_grammar_dlg"></div>
      <div th:replace="lexdialog :: add_od_lexeme_recommendation_dlg"></div>
      <div th:replace="lexdialog :: add_definition_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_source_link_dlg"></div>
      <div th:replace="lexdialog :: add_learner_comment_dlg"></div>
      <div th:replace="lexdialog :: add_meaning_relation_dlg"></div>
      <div th:replace="lexdialog :: add_meaning_domain_dlg"></div>
      <div th:replace="lexdialog :: add_meaning_semantic_type_dlg"></div>
      <div th:replace="lexdialog :: add_government_dlg"></div>
      <div th:replace="lexdialog :: add_usage_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_note_dlg"></div>
      <div th:replace="lexdialog :: add_meaning_note_dlg"></div>
      <div th:replace="lexdialog :: add_lexeme_relation_dlg"></div>
      <div th:replace="lexdialog :: edit_lexeme_publicity_dlg"></div>
      <div th:replace="lexdialog :: edit_lexeme_value_state_dlg"></div>
      <div th:replace="lexdialog :: edit_lexeme_levels_dlg"></div>
      <div th:replace="lexdialog :: edit_lexeme_complexity_dlg"></div>
      <div th:replace="lexdialog :: edit_lexeme_weight_dlg"></div>
      <div class="card-body">
        <button type="button" name="lexeme-details-btn"
                class="btn btn-secondary btn-sm btn-toggle float-right" title="Peida detailid"
                th:data-id="${lexeme.lexemeId}" th:data-lex-levels="${lexeme.levels}" th:data-composition="lite">
          <i class="fa fa-angle-up" aria-hidden="true"></i>
        </button>
        <div class="d-flex flex-row align-items-center flex-wrap">
          <div class="d-flex flex-wrap">
            <span class="btn pl-1 pr-1" th:if="${lexeme.levels != null}"
                  th:data-id="${lexeme.lexemeId}"
                  th:data-level1="${lexeme.level1}"
                  th:data-level2="${lexeme.level2}"
                  data-toggle="modal"
                  th:data-target="${'#editLexemeLevelsDlg_' + lexeme.lexemeId}"
                  sec:authorize="#vars.lexeme.crudGrant">
              <span class="bubble">
                <span th:text="${lexeme.levels}"></span>
              </span>
            </span>
            <span class="pl-1 pr-1" th:if="${!lexeme.crudGrant}">
              <span class="bubble">
                <span th:text="${lexeme.levels}"></span>
              </span>
            </span>
            <div>
              <div th:each="meaningWordLangGroup : ${lexeme.meaningWordLangGroups}"
                   class="orderable d-flex flex-row flex-wrap mr-2"
                   data-op-code="lexeme_meaning_word"
                   th:data-additional-info="${lexeme.lexemeId}">
                <span th:if="${lexeme.wordLang == meaningWordLangGroup.lang}" class="mr-2" th:text="#{syn.abbreviation}"></span>
                <span th:unless="${lexeme.wordLang == meaningWordLangGroup.lang}" th:text="${viewUtil.getLangIso2(meaningWordLangGroup.lang)}" class="mr-2"></span>
                <div th:each="meaningWord,meaningWordIter : ${meaningWordLangGroup.meaningWords}"
                     class="orderable-item"
                     th:data-id="${meaningWord.lexemeId}"
                     th:data-orderby="${meaningWord.orderBy}">
                  <div th:replace="lexdialog :: edit_meaning_word_and_lexeme_weight_dlg"></div>
                  <div class="hidden-buttons">
                    <button type="button" class="btn badge badge-secondary do-refresh order-up"
                            title="Muuda järjestust"
                            th:hidden="${meaningWordIter.first}"
                            sec:authorize="#vars.lexeme.crudGrant">
                      <i class="fa fa-arrow-left" aria-hidden="true"></i>
                    </button>
                    <button
                      type="button"
                      class="btn btn-link p-0"
                      th:data-id="${meaningWord.wordId}"
                      name="details-btn"
                      data-behaviour="replace"
                      data-plugin="contextmenu"
                      data-contextmenu:compare="Ava uues paneelis">
                      <span th:utext="${viewUtil.getWordValueMarkup(meaningWord)}"></span>
                      <span th:text="${meaningWord.homonymNr}"></span>
                      <span th:text="${'[ ' + viewUtil.getFormattedLexemeWeight(meaningWord.lexemeWeight) + ' ]'}"></span>
                    </button>
                    <button type="button" class="btn badge badge-primary"
                            title="Muuda vastet"
                            data-toggle="modal"
                            th:data-target="${'#editMeaningWordAndLexemeWeightDlg_' + meaningWord.lexemeId}"
                            sec:authorize="#vars.lexeme.crudGrant">
                      <i class="fa fa-edit" aria-hidden="true"></i>
                    </button>
                    <button th:id="${'duplicateMeaningWordAndLexemeBtn_' + lexeme.lexemeId}"
                            th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                            th:data-lexeme-id="${meaningWord.lexemeId}"
                            class="btn badge badge-primary"
                            title="Tee vastest duplikaat"
                            sec:authorize="#vars.lexeme.crudGrant">
                      <i class="fa fa-clone" aria-hidden="true"></i>
                    </button>
                    <button type="button" class="btn badge badge-warning"
                            th:data-id="${meaningWord.lexemeId}"
                            data-callback="refreshDetailsSearch"
                            data-toggle="deleteLexemeAndWordAndMeaning"
                            sec:authorize="#vars.lexeme.crudGrant">
                      <i class="fa fa-remove" aria-hidden="true"></i>
                    </button>
                    <button type="button" class="btn badge badge-secondary do-refresh order-down"
                            title="Muuda järjestust"
                            th:hidden="${meaningWordIter.last}"
                            sec:authorize="#vars.lexeme.crudGrant">
                      <i class="fa fa-arrow-right" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- testing meaning words as meaning relations -->
            <div th:if="${not #lists.isEmpty(lexeme.meaning.viewSynRelations)}" class="mb-2">
              <div class="w-100 p-1">
                <hr/>
              </div>
              <span th:each="relations, relsIter : ${lexeme.meaning.viewSynRelations}" th:with="relSample = ${relations.get(0)}">
                <th:block th:each="relation, relIter : ${relations}">
                  <button
                    type="button"
                    class="btn btn-link p-0"
                    th:data-id="${relation.wordId}"
                    name="details-btn"
                    data-behaviour="replace"
                    data-plugin="contextmenu"
                    data-contextmenu:compare="Ava uues paneelis">
                    <span th:utext="${viewUtil.getWordValueMarkup(relation)}"></span>
                    <span th:text="${relation.wordHomonymNr}"></span>
                    <span th:text="${'(' + viewUtil.getLangIso2(relation.wordLang) + ')'}"></span>
                    <small th:text="${viewUtil.getFormattedLexemeWeight(relSample.weight)}" class="text-secondary"></small>
                  </button>
                  <span th:unless="${relIter.last}">,</span>
                </th:block>
                <span th:unless="${relsIter.last}">|</span>
              </span>
            </div>
          </div>
          <div>
            <a class="btn btn-sm btn-primary" title="Ühenda tähendused" th:href="@{'/lexjoin/' + ${lexeme.lexemeId}}" sec:authorize="#vars.lexeme.crudGrant">Ühenda</a>
<!--                      TODO this functionality is (temporarily) not needed. Enable this function or delete related code when decision is made what to do with this (19.02.2020) -->
<!--                      <a class="btn btn-sm btn-primary" th:href="@{'/lexseparate/' + ${lexeme.lexemeId}}"-->
<!--                         th:if="${!#lists.isEmpty(lexeme.meaningWordLangGroups)}" data-toggle="confirmation"-->
<!--                         data-placement="right"-->
<!--                         data-title="Kas olete kindel, et soovite viia sõna eraldi tähendusse ?"-->
<!--                         sec:authorize="#vars.lexeme.crudGrant">Lahuta</a>-->
            <button th:id="${'duplicateLexemeBtn_' + lexeme.lexemeId}" class="btn btn-sm btn-primary"
                    title="Tee duplikaat ilmikust ja temaga seotud elementidest"
                    th:data-lexeme-id="${lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">Duplikaat</button>
            <button class="btn btn-sm btn-primary" data-toggle="modal"
                    data-target="#newWordDlg"
                    th:data-meaning-id="${lexeme.meaningId}"
                    sec:authorize="#vars.isMeaningAnyLexemeCrudGranted && #vars.userRoleData.crudRoleSelected">Uus keelend</button>
            <button th:id="${'duplicateEmptyLexemeBtn_' + lexeme.lexemeId}" class="btn btn-sm btn-primary"
                    title="Loo uus ilmik ja tähendus"
                    th:data-lexeme-id="${lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">Uus tähendus</button>
            <span class="dropdown" sec:authorize="#vars.lexeme.crudGrant">
              <button class="btn btn-warning font-weight-bold btn-sm" id="deleteButton" type="button" data-toggle="dropdown" aria-haspopup="true"
                      aria-expanded="false">Kustuta</button>
              <span class="dropdown-menu" aria-labelledby="deleteButton">
                <a class="btn btn-secondary font-weight-bold btn-sm"
                   href="#"
                   th:data-id="${lexeme.lexemeId}"
                   data-callback="doNewSearchLexDetail"
                   data-toggle="deleteLexemeAndWordAndMeaning"
                   sec:authorize="#vars.lexeme.crudGrant">Kustuta koos tähendusega</a>
                <a class="btn btn-secondary font-weight-bold btn-sm"
                   href="#"
                   th:data-id="${lexeme.lexemeId}"
                   data-callback="doNewSearchLexDetail"
                   data-toggle="deleteLexemeAndRusMeaningLexemes"
                   sec:authorize="#vars.lexeme.crudGrant">Kustuta koos tähenduse ja venekeelsete vastetega</a>
              </span>
            </span>
            <a th:href="@{'/meaningactivitylog:' + ${lexeme.meaningId}}" data-toggle="modal"
               data-target="#meaningActivityLogDlg"
               class="btn btn-secondary btn-compact ml-2">Logi</a>
          </div>
          <div class="ml-auto">
            <b th:text="${lexeme.datasetName}"></b>
          </div>
        </div>
        <div>
          <hr/>
          <span class="lbl" th:unless="${lexeme.lexemeOrMeaningClassifiersExist}">Ilmiku omadused</span>
          <div class="text-right">
            <button type="button" class="btn badge badge-success"
                    title="Lisa andmeid"
                    data-toggle="modal"
                    th:data-target="${'#addLexemeDataDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <th:block th:replace="lexcomp :: data_ids"></th:block>
          <th:block th:replace="lexcomp :: tags"></th:block>
          <th:block th:replace="lexcomp :: lexeme_complexity"></th:block>
          <th:block th:replace="lexcomp :: lexeme_publicity"></th:block>
          <th:block th:replace="lexcomp :: lexeme_value_state"></th:block>
          <th:block th:replace="lexcomp :: lexeme_grammar"></th:block>
          <th:block th:replace="lexcomp :: lexeme_weight"></th:block>
          <th:block th:replace="lexcomp :: lexeme_pos"></th:block>
          <th:block th:replace="lexcomp :: lexeme_derivative"></th:block>
          <th:block th:replace="lexcomp :: lexeme_register"></th:block>
          <th:block th:replace="lexcomp :: meaning_domain"></th:block>
          <th:block th:replace="lexcomp :: meaning_semantic_type"></th:block>
        </div>
        <div class="row">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Seletused</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa uus"
                    data-toggle="modal"
                    th:data-target="${'#addDefinitionDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.isMeaningLexemeCrudGranted">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <th:block th:each="definitionLangGroup : ${lexeme.meaning.definitionLangGroups}">
              <div>
                <span th:text="${viewUtil.getLangIso2(definitionLangGroup.lang)}" class="mr-2"></span>
                <button name="lang-collapse-btn" type="button" class="btn badge badge-secondary btn-toggle"
                        th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                        th:data-lang="${definitionLangGroup.lang}"
                        th:title="${definitionLangGroup.selected ? 'Peida keele grupp' : 'Näita keele grupp'}">
                  <i th:class="${definitionLangGroup.selected ? 'fa fa-angle-down' : 'fa fa-angle-right'}" aria-hidden="true"></i>
                </button>
              </div>
              <div th:if="${definitionLangGroup.selected}" class="orderable" data-op-code="definition">
                <div class="ml-4" style="position: relative;" th:each="definition, itemIter: ${definitionLangGroup.definitions}"
                     th:data-id="${definition.id}"
                     th:data-orderby="${definition.orderBy}">
                  <div th:replace="lexdialog :: edit_definition_dlg"></div>
                  <div th:replace="lexdialog :: add_definition_source_link_dlg"></div>
                  <div th:replace="lexdialog :: add_definition_note_dlg"></div>
                  <div style="position: absolute; display: list-item;"></div>
                  <div class="action-column">
                    <th:block th:replace="common :: ordering_buttons(${itemIter})" sec:authorize="#vars.lexeme.meaning.crudGrant"></th:block>
                  </div>
                  <div class="invisible-buttons action-buttons-anchor mw-80">
                    <span th:utext="${definition.value}"></span>
                    <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${definition.complexity}} + ')'"></span>
                    <span class="ctxt" th:each="datasetCode,iter : ${definition.datasetCodes}" th:text="${(iter.first ? '[' : '') + datasetCode + (iter.last ? ']' : ', ')}"></span>
                    <span class="ctxt" th:text="'(' + #{'boolean.public.' + ${definition.public}} + ')'" th:if="${definition.crudGrant}"></span>
                    <span th:if="${#lists.isEmpty(definition.sourceLinks)}" class="show-on-mouseover">
                      [
                      <button type="button" class="btn badge badge-success"
                              title="Lisa allikaviide"
                              data-toggle="modal"
                              th:data-target="${'#addDefinitionSourceLinkDlg_' + lexeme.lexemeId + '_' + definition.id}"
                              sec:authorize="#vars.definition.crudGrant">
                        <i class="fa fa-external-link" aria-hidden="true"></i>
                      </button>
                      ]
                    </span>
                    <div class="action-buttons-3">
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editDefinitionDlg_' + lexeme.lexemeId + '_' + definition.id}"
                              sec:authorize="#vars.definition.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-success"
                              title="Lisa märkus"
                              data-toggle="modal"
                              th:data-target="${'#addDefinitionNoteDlg_' + lexeme.lexemeId + '_' + definition.id}"
                              sec:authorize="#vars.definition.crudGrant">
                        <i class="fa fa-sticky-note-o" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="definition"
                              th:data-id="${definition.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.definition.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                  <div class="hidden-buttons">
                    <span th:each="sourceLink : ${definition.sourceLinks}" th:if="${not #lists.isEmpty(definition.sourceLinks)}">
                      [
                      <a th:href="@{'/def_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}"></a>
                      <span th:if="${sourceLink.name != null}" th:text="${sourceLink.name}"></span>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="def_source_link"
                              th:data-id="${sourceLink.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.definition.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                      ]
                    </span>
                    <button type="button" class="btn badge badge-success"
                            title="Lisa allikaviide"
                            data-toggle="modal"
                            th:data-target="${'#addDefinitionSourceLinkDlg_' + lexeme.lexemeId + '_' + definition.id}"
                            sec:authorize="#vars.definition.crudGrant">
                      <i class="fa fa-external-link" aria-hidden="true"></i>
                    </button>
                  </div>
                  <div th:if="${not #lists.isEmpty(definition.notes)}" class="col pl-0">
                    <div>
                      <span class="lbl">Märkused</span>
                    </div>
                    <th:block th:each="note : ${definition.notes}">
                      <div th:replace="lexdialog :: edit_definition_note_dlg"></div>
                      <div th:replace="lexdialog :: add_definition_note_source_link_dlg"></div>
                      <div class="small invisible-buttons action-buttons-anchor mw-90 ml-4">
                        <div style="position: absolute; display: list-item;"></div>
                        <span th:utext="${note.valuePrese}"></span>
                        <span class="ctxt" th:text="'(' + #{'boolean.public.' + ${note.public}} + ')'" th:if="${definition.crudGrant}"></span>
                        <span class="show-on-mouseover" th:if="${#lists.isEmpty(note.sourceLinks)}">
                          [
                          <button type="button" class="btn badge badge-success"
                                  title="Lisa allikaviide"
                                  data-toggle="modal"
                                  th:data-target="${'#addDefinitionNoteSourceLinkDlg_' + definition.id + '_' + note.id}"
                                  sec:authorize="#vars.definition.crudGrant">
                            <i class="fa fa-external-link" aria-hidden="true"></i>
                          </button>
                          ]
                        </span>
                        <div class="action-buttons-2">
                          <button type="button" class="btn badge badge-primary"
                                  th:title="Muuda"
                                  data-toggle="modal"
                                  th:data-target="${'#editDefinitionNoteDlg_' + lexeme.lexemeId + '_' + note.id}"
                                  sec:authorize="#vars.definition.crudGrant">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-warning"
                                  th:data-id="${note.id}"
                                  data-op-code="definition_note"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.definition.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                        </div>
                      </div>
                      <div class="small hidden-buttons ml-4">
                        <span th:each="sourceLink : ${note.sourceLinks}">
                          [
                          <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}"></a>
                          <span th:if="${sourceLink.name != null}">
                            <span th:text="${sourceLink.name}"></span>
                          </span>
                          <button type="button" class="btn badge badge-warning"
                                  th:data-id="${sourceLink.id}"
                                  data-op-code="definition_ff_source_link"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.definition.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          ]
                        </span>
                        <button type="button" class="btn badge badge-success"
                                title="Lisa allikaviide"
                                data-toggle="modal"
                                th:data-target="${'#addDefinitionNoteSourceLinkDlg_' + definition.id + '_' + note.id}"
                                sec:authorize="#vars.definition.crudGrant">
                          <i class="fa fa-external-link" aria-hidden="true"></i>
                        </button>
                      </div>
                    </th:block>
                  </div>
                </div>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.odLexemeRecommendations)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">ÕS soovitab</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa uus"
                    data-toggle="modal"
                    th:data-target="${'#addOdLexemeRecommendationDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <div th:each="odLexemeRecommendation, itemIter : ${lexeme.odLexemeRecommendations}">
              <div th:replace="lexdialog :: edit_od_lexeme_recommendation"></div>
              <div class="row">
                <div class="col hidden-buttons">
                  <div class="action-buttons-anchor">
                    <div class="pr-3">
                      <span th:utext="${odLexemeRecommendation.valuePrese}"></span>
                      <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${odLexemeRecommendation.complexity}} + ')'"></span>
                    </div>
                    <div class="action-buttons-2">
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editOdLexemeRecommendationDlg_' + lexeme.lexemeId + '_' + odLexemeRecommendation.id}"
                              sec:authorize="#vars.lexeme.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="od_lexeme_recommendation"
                              th:data-id="${odLexemeRecommendation.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.lexeme.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.sourceLinks)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Allikaviide</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa allikaviide"
                    data-toggle="modal"
                    th:data-target="${'#addLexemeSourceLinkDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">
              <i class="fa fa-external-link" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <span th:each="sourceLink : ${lexeme.sourceLinks}" class="hidden-buttons">
              [
              <a th:href="@{'/lex_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}"></a>
              <span th:if="${sourceLink.name != null}">
                <span th:text="${sourceLink.name}"></span>
              </span>
              <button type="button" class="btn badge badge-warning"
                      data-op-code="lex_source_link"
                      th:data-id="${sourceLink.id}"
                      th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                      data-toggle="delete-confirm"
                      data-placement="right"
                      sec:authorize="#vars.lexeme.crudGrant">
                <i class="fa fa-remove" aria-hidden="true"></i>
              </button>
              ]
            </span>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.meaning.learnerComments)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Õppekommentaarid</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa uus"
                    data-toggle="modal"
                    th:data-target="${'#addLearnerCommentDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.meaning.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <th:block th:each="learnerComment : ${lexeme.meaning.learnerComments}">
              <div th:replace="lexdialog :: edit_learner_comment_dlg"></div>
              <div class="row">
                <div class="col hidden-buttons">
                  <div class="action-buttons-anchor">
                    <span th:utext="${learnerComment.valuePrese}"></span>
                    <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${learnerComment.complexity}} + ')'"></span>
                    <div class="action-buttons-2">
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editLearnerCommentDlg_' + lexeme.lexemeId + '_' + learnerComment.id}"
                              sec:authorize="#vars.lexeme.meaning.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="learner_comment"
                              th:data-id="${learnerComment.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.lexeme.meaning.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.meaning.images)}">
          <hr>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Pildid</span>
          </div>
          <div class="col pl-0">
            <th:block th:each="image : ${lexeme.meaning.images}">
              <div th:replace="lexdialog :: add_image_title_dlg"></div>
              <div th:replace="lexdialog :: edit_image_title_dlg"></div>
              <div th:replace="lexdialog :: add_image_source_link_dlg"></div>
              <div class="invisible-buttons action-buttons-anchor w-100">
                <img class="w-50" th:src="@{'/files/images/' + ${image.fileName}}">
                <button type="button" class="btn badge badge-warning align-top"
                        title="Kustuta pilt"
                        data-op-code="meaning_image"
                        th:data-id="${image.id}"
                        th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                        data-toggle="delete-confirm"
                        sec:authorize="#vars.lexeme.meaning.crudGrant">
                  <i class="fa fa-remove" aria-hidden="true"></i>
                </button>
                <span th:if="${#strings.isEmpty(image.title)}">
                  <button type="button" class="btn badge badge-success align-bottom"
                          title="Lisa pealkiri"
                          data-toggle="modal"
                          th:data-target="${'#addImageTitleDlg_' + image.id}"
                          sec:authorize="#vars.lexeme.meaning.crudGrant">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                  </button>
                  <button type="button" class="btn badge badge-success align-bottom"
                          title="Lisa allikaviide"
                          data-toggle="modal"
                          th:data-target="${'#addImageSourceLinkDlg_' + image.id}"
                          sec:authorize="#vars.lexeme.meaning.crudGrant">
                    <i class="fa fa-external-link" aria-hidden="true"></i>
                  </button>
                </span>
              </div>
              <div class="col pl-0" th:if="${#strings.isEmpty(image.title)}">
                <span th:each="sourceLink : ${image.sourceLinks}" class="hidden-buttons">
                  [
                  <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}"></a>
                  <span th:if="${sourceLink.name != null}">
                    <span th:text="${sourceLink.name}"></span>
                  </span>
                  <button type="button" class="btn badge badge-warning"
                          data-op-code="meaning_ff_source_link"
                          th:data-id="${sourceLink.id}"
                          th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                          data-toggle="delete-confirm"
                          data-placement="right"
                          sec:authorize="#vars.lexeme.meaning.crudGrant">
                    <i class="fa fa-remove" aria-hidden="true"></i>
                  </button>
                  ]
                </span>
              </div>
              <div th:unless="${#strings.isEmpty(image.title)}">
                <div class="invisible-buttons action-buttons-anchor mw-90">
                  <span th:text="${image.title}"></span>
                  <span class="show-on-mouseover" th:if="${#lists.isEmpty(image.sourceLinks)}">
                    [
                    <button type="button" class="btn badge badge-success"
                            title="Lisa allikaviide"
                            data-toggle="modal"
                            th:data-target="${'#addImageSourceLinkDlg_' + image.id}"
                            sec:authorize="#vars.lexeme.meaning.crudGrant">
                      <i class="fa fa-external-link" aria-hidden="true"></i>
                    </button>
                    ]
                  </span>
                  <div class="action-buttons-2">
                    <button type="button" class="btn badge badge-primary"
                            th:title="Muuda"
                            data-toggle="modal"
                            th:data-target="${'#editImageTitleDlg_' + image.id}"
                            sec:authorize="#vars.lexeme.meaning.crudGrant">
                      <i class="fa fa-edit" aria-hidden="true"></i>
                    </button>
                    <button type="button" class="btn badge badge-warning"
                            data-op-code="image_title"
                            th:data-id="${image.id}"
                            th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                            data-toggle="delete-confirm"
                            data-placement="right"
                            sec:authorize="#vars.lexeme.meaning.crudGrant">
                      <i class="fa fa-remove" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
                <div class="hidden-buttons">
                  <span th:each="sourceLink : ${image.sourceLinks}">
                    [
                    <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}"></a>
                    <span th:if="${sourceLink.name != null}">
                      <span th:text="${sourceLink.name}"></span>
                    </span>
                    <button type="button" class="btn badge badge-warning"
                            data-op-code="meaning_ff_source_link"
                            th:data-id="${sourceLink.id}"
                            th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                            data-toggle="delete-confirm"
                            data-placement="right"
                            sec:authorize="#vars.lexeme.meaning.crudGrant">
                      <i class="fa fa-remove" aria-hidden="true"></i>
                    </button>
                    ]
                  </span>
                  <button type="button" class="btn badge badge-success"
                          title="Lisa allikaviide"
                          data-toggle="modal"
                          th:data-target="${'#addImageSourceLinkDlg_' + image.id}"
                          sec:authorize="#vars.lexeme.meaning.crudGrant">
                    <i class="fa fa-external-link" aria-hidden="true"></i>
                  </button>
                </div>
                <hr>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.meaning.freeforms)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Tähenduse atribuudid</span>
          </div>
          <div class="col pl-0">
            <table>
              <tr th:each="freeform : ${lexeme.meaning.freeforms}">
                <td class="align-text-top pr-3">
                  <span th:text="${freeform.type}"></span>
                </td>
                <td>
                  <span th:utext="${freeform.valueText}" th:if="${freeform.valueText != null}"></span>
                  <span th:text="${#dates.format(freeform.valueDate, 'dd.MM.yyyy HH:mm')}" th:if="${freeform.valueDate != null}"></span>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.meaning.viewOtherRelations)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Tähenduse seosed</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa seos"
                    data-toggle="modal"
                    th:data-target="${'#addMeaningRelationDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.meaning.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <table class="table table-striped">
              <tr th:each="relations : ${lexeme.meaning.viewOtherRelations}" th:with="relSample = ${relations.get(0)}" class="hidden-buttons">
                <td class="pr-3" th:if="${userProfile.showMeaningRelationMeaningId}">
                  <span class="text-monospace" th:text="${relSample.meaningId}"></span>
                </td>
                <td class="pr-3">
                  <th:block th:each="relation, relIter : ${relations}">
                    <button
                      type="button"
                      class="btn btn-link btn-xs"
                      th:data-id="${relation.wordId}"
                      name="details-btn"
                      data-behaviour="replace"
                      data-plugin="contextmenu"
                      data-contextmenu:compare="Ava uues paneelis">
                      <span th:utext="${viewUtil.getWordValueMarkup(relation)}"></span>
                      <span th:text="${'(' + viewUtil.getLangIso2(relation.wordLang) + ')'}"></span>
                      <th:block th:each="datasetCode, dsIter : ${relation.datasetCodes}">
                        <span th:if="${dsIter.first}">[</span>
                        <span th:text="${datasetCode}"></span>
                        <span th:unless="${dsIter.last}">,</span>
                        <span th:if="${dsIter.last}">]</span>
                      </th:block>
                      <th:block th:unless="${#strings.isEmpty(relation.wordAspectCode)}">
                        <span th:text="${'[' + relation.wordAspectCode + ']'}"></span>
                      </th:block>
                      <th:block th:each="valueStateCode, vsIter : ${relation.lexemeValueStateCodes}">
                        <span th:if="${vsIter.first}">[</span>
                        <span th:text="${valueStateCode}"></span>
                        <span th:unless="${vsIter.last}">,</span>
                        <span th:if="${vsIter.last}">]</span>
                      </th:block>
                      <th:block th:each="registerCode, regIter : ${relation.lexemeRegisterCodes}">
                        <span th:if="${regIter.first}">[</span>
                        <span th:text="${registerCode}"></span>
                        <span th:unless="${regIter.last}">,</span>
                        <span th:if="${regIter.last}">]</span>
                      </th:block>
                      <th:block th:each="government, govIter : ${relation.lexemeGovernmentValues}">
                        <span th:if="${govIter.first}">[</span>
                        <span th:utext="${government}"></span>
                        <span th:unless="${govIter.last}">,</span>
                        <span th:if="${govIter.last}">]</span>
                      </th:block>
                    </button>
                    <span th:unless="${relIter.last}">,</span>
                  </th:block>
                </td>
                <td>
                  <span th:text="${relSample.relTypeLabel}"></span>
                  <small th:text="${relSample.weight}" class="text-secondary"></small>
                </td>
                <td>
                  <button type="button" class="btn badge badge-warning"
                          data-placement="right"
                          data-op-code="meaning_relation"
                          th:data-id="${relSample.id}"
                          th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                          data-toggle="delete-confirm"
                          sec:authorize="#vars.lexeme.meaning.crudGrant">
                    <i class="fa fa-remove" aria-hidden="true"></i>
                  </button>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.governments)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">
              Rektsioon
              <button type="button" class="btn badge badge-success float-right mr-4"
                      title="Lisa uus"
                      data-toggle="modal"
                      th:data-target="${'#addGovernmentDlg_' + lexeme.lexemeId}"
                      sec:authorize="#vars.lexeme.crudGrant">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
            </span>
          </div>
          <div class="col pl-0">
            <div class="orderable" data-op-code="government">
              <div th:each="government, itemIter : ${lexeme.governments}"
                   th:data-id="${government.id}"
                   th:data-orderby="${government.orderBy}">
                <div th:replace="lexdialog :: edit_government_dlg"></div>
                <div class="row">
                  <div class="action-column">
                    <th:block th:replace="common :: ordering_buttons(${itemIter})" sec:authorize="#vars.lexeme.meaning.crudGrant"></th:block>
                  </div>
                  <div class="col hidden-buttons">
                    <div class="action-buttons-anchor">
                      <span class="pr-3" th:text="${government.value}"></span>
                      <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${government.complexity}} + ')'"></span>
                      <div class="action-buttons-2">
                        <button type="button" class="btn badge badge-primary"
                                title="Muuda"
                                data-toggle="modal"
                                th:data-target="${'#editGovernmentDlg_' + lexeme.lexemeId + '_' + government.id}"
                                sec:authorize="#vars.lexeme.crudGrant">
                          <i class="fa fa-edit" aria-hidden="true"></i>
                        </button>
                        <button type="button" class="btn badge badge-warning"
                                data-op-code="government"
                                th:data-id="${government.id}"
                                th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                data-toggle="delete-confirm"
                                data-placement="right"
                                sec:authorize="#vars.lexeme.crudGrant">
                          <i class="fa fa-remove" aria-hidden="true"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.usages)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Kasutusnäited</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa uus"
                    data-toggle="modal"
                    th:data-target="${'#addUsageDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <th:block th:if="${not #lists.isEmpty(lexeme.usages)}">
              <div class="orderable" data-op-code="usage">
                <div th:each="usage,usageIter : ${lexeme.usages}"
                     th:data-id="${usage.id}"
                     th:data-orderby="${usage.orderBy}">
                <div th:replace="lexdialog :: edit_usage_dlg"></div>
                <div th:replace="lexdialog :: add_usage_member_dlg"></div>
                <div th:replace="lexdialog :: add_usage_author_dlg"></div>
                <div class="row">
                  <div class="action-column">
                    <th:block th:replace="common :: ordering_buttons(${usageIter})" sec:authorize="#vars.usage.crudGrant"></th:block>
                  </div>
                  <div class="col invisible-buttons">
                    <div class="action-buttons-anchor">
                      <div class="d-inline-block" th:utext="${usage.value}"></div>
                      <div class="d-inline-block" th:if="${usage.typeValue != null}" th:text="'(' + ${usage.typeValue + ')'}"></div>
                      <div class="d-inline-block ctxt" th:text="'(' + #{'enum.complexity.' + ${usage.complexity}} + ')'"></div>
                      <div class="d-inline-block ctxt" th:text="'(' + #{'boolean.public.' + ${usage.public}} + ')'" th:if="${usage.crudGrant}"></div>
                      <div th:if="${#lists.isEmpty(usage.authors)}" class="show-on-mouseover" sec:authorize="#vars.usage.crudGrant">
                        (
                        <button type="button" class="btn badge badge-success hidden"
                                title="Lisa autor/tõlkija"
                                data-toggle="modal"
                                th:data-target="${'#addUsageAuthorDlg_' + usage.id}"
                                sec:authorize="#vars.usage.crudGrant">
                          <i class="fa fa-plus" aria-hidden="true"></i>
                        </button>
                        )
                      </div>
                      <div class="d-inline-block" th:if="${not #lists.isEmpty(usage.authors)}">
                        (
                        <span th:each="sourceLink,sourceLinkIter : ${usage.authors}">
                          <span th:text="#{'enum.reference.type.' + ${sourceLink.type}} + ': '"></span>
                          <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}" th:text="${sourceLink.value}" th:if="${sourceLink.value != null}"></a>
                          <button type="button" class="btn badge badge-warning hidden"
                                  data-op-code="usage_author"
                                  th:data-id="${sourceLink.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          <span th:unless="${sourceLinkIter.last}">,</span>
                        </span>
                        <button type="button" class="btn badge badge-success hidden"
                                title="Lisa autor/tõlkija"
                                th:data-id="${usage.id}"
                                data-toggle="modal"
                                th:data-target="${'#addUsageAuthorDlg_' + usage.id}"
                                sec:authorize="#vars.usage.crudGrant">
                          <i class="fa fa-plus" aria-hidden="true"></i>
                        </button>
                        )
                      </div>
                      <div class="d-inline-block" th:if="${not #lists.isEmpty(usage.sourceLinks)}">
                        [
                        <span th:each="sourceLink,sourceLinkIter : ${usage.sourceLinks}">
                          <a th:href="@{'/ff_source_link:' + ${sourceLink.id}}" th:if="${sourceLink.value != null}">
                            <span th:text="${sourceLink.name}" th:if="${sourceLink.name != null}"></span>
                            <span th:text="${sourceLink.value}" th:if="${sourceLink.value != null}"></span>
                          </a>
                          <button type="button" class="btn badge badge-warning"
                                  data-op-code="usage_source_link"
                                  th:data-id="${sourceLink.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                        </span>
                        ]
                      </div>
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editUsageDlg_' + lexeme.lexemeId + '_' + usage.id}"
                              sec:authorize="#vars.usage.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="usage"
                              th:data-id="${usage.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.usage.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-success"
                              title="Lisa kasutusnäitele andmeid"
                              data-toggle="modal"
                              th:data-target="${'#addUsageMemberDlg_' + lexeme.lexemeId + '_' + usage.id}"
                              sec:authorize="#vars.usage.crudGrant">
                        <i class="fa fa-plus" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div th:if="${not #lists.isEmpty(usage.translations)}" class="col pl-0">
                  <div>
                    <span class="lbl">Tõlked</span>
                  </div>
                  <div class="row" th:each="usageTranslation : ${usage.translations}">
                    <div th:replace="lexdialog :: edit_usage_translation_dlg"></div>
                    <div class="col hidden-buttons ml-2">
                      <!-- intentional generic lexeme perm on translations -->
                      <div class="action-buttons-anchor">
                        <span th:utext="${usageTranslation.value}"></span>
                        <div class="action-buttons-3">
                          <button type="button" class="btn badge badge-primary"
                                  title="Muuda"
                                  data-toggle="modal"
                                  th:data-target="${'#editUsageTranslationDlg_' + lexeme.lexemeId + '_' + usage.id + '_' + usageTranslation.id}"
                                  sec:authorize="#vars.lexeme.crudGrant">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-warning"
                                  data-op-code="usage_translation"
                                  th:data-id="${usageTranslation.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.lexeme.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-success"
                                  title="Lisa uus"
                                  data-toggle="modal"
                                  th:data-target="${'#addUsageMemberDlg_' + lexeme.lexemeId + '_' + usage.id}"
                                  sec:authorize="#vars.lexeme.crudGrant">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div th:if="${not #lists.isEmpty(usage.definitions)}" class="col pl-0">
                  <div>
                    <span class="lbl">Seletused</span>
                  </div>
                  <div class="row" th:each="usageDefinition : ${usage.definitions}">
                    <div th:replace="lexdialog :: edit_usage_definition_dlg"></div>
                    <div class="col hidden-buttons ml-2">
                      <div class="action-buttons-anchor">
                        <span th:utext="${usageDefinition.value}"></span>
                        <div class="action-buttons-3">
                          <button type="button" class="btn badge badge-primary"
                                  title="Muuda"
                                  data-toggle="modal"
                                  th:data-target="${'#editUsageDefinitionDlg_' + lexeme.lexemeId + '_' + usage.id + '_' + usageDefinition.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-warning"
                                  data-op-code="usage_definition"
                                  th:data-id="${usageDefinition.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-success"
                                  title="Lisa uus"
                                  data-toggle="modal"
                                  th:data-target="${'#addUsageMemberDlg_' + lexeme.lexemeId + '_' + usage.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div th:if="${not #lists.isEmpty(usage.odDefinitions)}" class="col pl-0">
                  <div>
                    <span class="lbl">ÕSi sõnastussoovitused</span>
                  </div>
                  <div class="row" th:each="odUsageDefinition : ${usage.odDefinitions}">
                    <div th:replace="lexdialog :: edit_od_usage_definition_dlg"></div>
                    <div class="col hidden-buttons ml-2">
                      <div class="action-buttons-anchor">
                        <span th:utext="${odUsageDefinition.value}"></span>
                        <div class="action-buttons-3">
                          <button type="button" class="btn badge badge-primary"
                                  title="Muuda"
                                  data-toggle="modal"
                                  th:data-target="${'#editOdUsageDefinitionDlg_' + lexeme.lexemeId + '_' + usage.id + '_' + odUsageDefinition.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-warning"
                                  data-op-code="od_usage_definition"
                                  th:data-id="${odUsageDefinition.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-success"
                                  title="Lisa uus"
                                  data-toggle="modal"
                                  th:data-target="${'#addUsageMemberDlg_' + lexeme.lexemeId + '_' + usage.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div th:if="${not #lists.isEmpty(usage.odAlternatives)}" class="col pl-0">
                  <div>
                    <span class="lbl">ÕSi variandid</span>
                  </div>
                  <div class="row" th:each="odUsageAlternative : ${usage.odAlternatives}">
                    <div th:replace="lexdialog :: edit_od_usage_alternative_dlg"></div>
                    <div class="col hidden-buttons ml-2">
                      <div class="action-buttons-anchor">
                        <span th:utext="${odUsageAlternative.value}"></span>
                        <div class="action-buttons-3">
                          <button type="button" class="btn badge badge-primary"
                                  title="Muuda"
                                  data-toggle="modal"
                                  th:data-target="${'#editOdUsageAlternativeDlg_' + lexeme.lexemeId + '_' + usage.id + '_' + odUsageAlternative.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-edit" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-warning"
                                  data-op-code="od_usage_alternative"
                                  th:data-id="${odUsageAlternative.id}"
                                  th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                                  data-toggle="delete-confirm"
                                  data-placement="right"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-remove" aria-hidden="true"></i>
                          </button>
                          <button type="button" class="btn badge badge-success"
                                  title="Lisa uus"
                                  data-toggle="modal"
                                  th:data-target="${'#addUsageMemberDlg_' + lexeme.lexemeId + '_' + usage.id}"
                                  sec:authorize="#vars.usage.crudGrant">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="w-50" th:unless="${usageIter.last}">
                  <hr/>
                </div>
              </div>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.lexemeNoteLangGroups)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">
              Ilmiku märkused
              <button type="button" class="btn badge badge-success float-right mr-4"
                      title="Lisa uus"
                      data-toggle="modal"
                      th:data-target="${'#addLexemeNoteDlg_' + lexeme.lexemeId}"
                      sec:authorize="#vars.lexeme.crudGrant">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
            </span>
          </div>
          <div class="col pl-0">
            <th:block th:each="noteLangGroup : ${lexeme.lexemeNoteLangGroups}">
              <div>
                <span th:text="${viewUtil.getLangIso2(noteLangGroup.lang)}" class="mr-2"></span>
                <button name="lang-collapse-btn" type="button" class="btn badge badge-secondary btn-toggle"
                        th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                        th:data-lang="${noteLangGroup.lang}"
                        th:title="${noteLangGroup.selected ? 'Peida keele grupp' : 'Näita keele grupp'}">
                  <i th:class="${noteLangGroup.selected ? 'fa fa-angle-down' : 'fa fa-angle-right'}" aria-hidden="true"></i>
                </button>
              </div>
              <div th:if="${noteLangGroup.selected}" class="orderable" data-op-code="lexeme_note">
                <div class="ml-4" style="position: relative;" th:each="note, itemIter: ${noteLangGroup.notes}"
                     th:data-id="${note.id}"
                     th:data-orderby="${note.orderBy}">
                  <div th:replace="lexdialog :: edit_lexeme_note_dlg"></div>
                  <div style="position: absolute; display: list-item;"></div>
                  <div class="action-column">
                    <th:block th:replace="common :: ordering_buttons(${itemIter})" sec:authorize="#vars.lexeme.crudGrant"></th:block>
                  </div>
                  <div class="invisible-buttons action-buttons-anchor mw-90">
                    <span th:utext="${note.valuePrese}"></span>
                    <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${note.complexity}} + ')'"></span>
                    <span class="ctxt" th:text="'(' + #{'boolean.public.' + ${note.public}} + ')'" th:if="${lexeme.crudGrant}"></span>
                    <div class="action-buttons-2">
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editLexemeNoteDlg_' + lexeme.lexemeId + '_' + note.id}"
                              sec:authorize="#vars.lexeme.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="lexeme_note"
                              th:data-id="${note.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.lexeme.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.meaning.noteLangGroups)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">
              Tähenduse märkused
              <button type="button" class="btn badge badge-success float-right mr-4"
                      title="Lisa uus"
                      data-toggle="modal"
                      th:data-target="${'#addMeaningNoteDlg_' + lexeme.lexemeId}"
                      sec:authorize="#vars.lexeme.meaning.crudGrant">
                <i class="fa fa-plus" aria-hidden="true"></i>
              </button>
            </span>
          </div>
          <div class="col pl-0">
            <th:block th:each="noteLangGroup : ${lexeme.meaning.noteLangGroups}">
              <div>
                <span th:text="${viewUtil.getLangIso2(noteLangGroup.lang)}" class="mr-2"></span>
                <button name="lang-collapse-btn" type="button" class="btn badge badge-secondary btn-toggle"
                        th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                        th:data-lang="${noteLangGroup.lang}"
                        th:title="${noteLangGroup.selected ? 'Peida keele grupp' : 'Näita keele grupp'}">
                  <i th:class="${noteLangGroup.selected ? 'fa fa-angle-down' : 'fa fa-angle-right'}" aria-hidden="true"></i>
                </button>
              </div>
              <div th:if="${noteLangGroup.selected}" class="orderable" data-op-code="meaning_note">
                <div class="ml-4" style="position: relative;" th:each="note, itemIter: ${noteLangGroup.notes}"
                     th:data-id="${note.id}"
                     th:data-orderby="${note.orderBy}">
                  <div th:replace="lexdialog :: edit_meaning_note_dlg"></div>
                  <div style="position: absolute; display: list-item;"></div>
                  <div class="action-column">
                    <th:block th:replace="common :: ordering_buttons(${itemIter})" sec:authorize="#vars.lexeme.meaning.crudGrant"></th:block>
                  </div>
                  <div class="invisible-buttons action-buttons-anchor mw-90">
                    <span th:utext="${note.valuePrese}"></span>
                    <span class="ctxt" th:text="'(' + #{'enum.complexity.' + ${note.complexity}} + ')'" th:if="${lexeme.meaning.crudGrant}"></span>
                    <span class="ctxt" th:text="'(' + #{'boolean.public.' + ${note.public}} + ')'" th:if="${lexeme.meaning.crudGrant}"></span>
                    <div class="action-buttons-2">
                      <button type="button" class="btn badge badge-primary"
                              title="Muuda"
                              data-toggle="modal"
                              th:data-target="${'#editMeaningNoteDlg_' + lexeme.lexemeId + '_' + note.id}"
                              sec:authorize="#vars.lexeme.meaning.crudGrant">
                        <i class="fa fa-edit" aria-hidden="true"></i>
                      </button>
                      <button type="button" class="btn badge badge-warning"
                              data-op-code="meaning_note"
                              th:data-id="${note.id}"
                              th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                              data-toggle="delete-confirm"
                              data-placement="right"
                              sec:authorize="#vars.lexeme.meaning.crudGrant">
                        <i class="fa fa-remove" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </th:block>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.lexemeFreeforms)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Ilmiku atribuudid</span>
          </div>
          <div class="col pl-0">
            <table>
              <tr th:each="freeform : ${lexeme.lexemeFreeforms}">
                <td class="align-text-top pr-3">
                  <span th:text="${freeform.type}"></span>
                </td>
                <td>
                  <span th:utext="${freeform.valueText}" th:if="${freeform.valueText != null}"></span>
                  <span th:text="${#dates.format(freeform.valueDate, 'dd.MM.yyyy HH:mm')}" th:if="${freeform.valueDate != null}"></span>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="row" th:if="${not #lists.isEmpty(lexeme.lexemeRelations)}">
          <hr/>
          <div class="col pr-0 col-w13rem">
            <span class="lbl">Ilmiku seosed</span>
            <button type="button" class="btn badge badge-success float-right mr-4"
                    title="Lisa seos"
                    data-toggle="modal"
                    th:data-target="${'#addLexemeRelationDlg_' + lexeme.lexemeId}"
                    sec:authorize="#vars.lexeme.crudGrant">
              <i class="fa fa-plus" aria-hidden="true"></i>
            </button>
          </div>
          <div class="col pl-0">
            <table class="orderable" data-op-code="lexeme_relation" th:if="${not #lists.isEmpty(lexeme.lexemeRelations)}">
              <tr th:each="relation, itemIter : ${lexeme.lexemeRelations}" th:data-id="${relation.id}" th:data-orderby="${relation.orderBy}">
                <td class="action-column">
                  <th:block th:replace="common :: ordering_buttons(${itemIter})" sec:authorize="#vars.lexeme.crudGrant"></th:block>
                </td>
                <td class="pr-3 invisible-buttons">
                  <button
                    type="button"
                    class="btn btn-link btn-xs"
                    th:data-id="${relation.wordId}"
                    name="details-btn"
                    data-plugin="contextmenu"
                    data-contextmenu:compare="Ava uues paneelis"
                    data-behaviour="replace">
                    <span th:utext="${viewUtil.getWordValueMarkup(relation) + ' (' + viewUtil.getLangIso2(relation.wordLang) + ')'}"></span>
                  </button>
                  <button type="button" class="btn badge badge-warning"
                          data-op-code="lexeme_relation"
                          th:data-id="${relation.id}"
                          th:data-callback="${viewUtil.composeFunction('loadFullLexemeDetails', lexeme.lexemeId, lexeme.levels)}"
                          data-toggle="delete-confirm"
                          data-placement="left"
                          sec:authorize="#vars.lexeme.crudGrant">
                    <i class="fa fa-remove" aria-hidden="true"></i>
                  </button>
                </td>
                <td class="invisible-buttons">
                  <span th:text="${relation.relTypeLabel}"></span>
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="pt-2" th:if="${not #lists.isEmpty(lexeme.collocationPosGroups)}">
          <span class="lbl">Kollokatsioonid</span>
          <th:block th:each="collocPosGr : ${lexeme.collocationPosGroups}">
            <div class="border rounded p-2 mb-3">
              <span th:text="${collocPosGr.code}"></span>
              <th:block th:each="collocRelGr, iter : ${collocPosGr.relationGroups}">
                <div class="border rounded p-2" th:classappend="${iter.last ? '' : 'mb-3'}">
                  <p>
                    <span th:text="${collocRelGr.name}"></span>
                    <span th:if="${collocRelGr.frequency != null}">
                      &nbsp;
                      <span class="lbl">Sagedus:</span>
                      <span th:text="${collocRelGr.frequency}"></span>
                    </span>
                    <span th:if="${collocRelGr.score != null}">
                      &nbsp;
                      <span class="lbl">Skoor:</span>
                      <span th:text="${collocRelGr.score}"></span>
                    </span>
                  </p>
                  <table class="with-horizontal-padding">
                    <tr th:each="colloc : ${collocRelGr.collocations}">
                      <td>
                        <span th:text="${colloc.value}"></span>
                      </td>
                      <td>
                        <span th:each="collocMember,collocMemberIter : ${colloc.collocMembers}">
                          <button
                            type="button"
                            class="btn btn-link"
                            th:data-id="${collocMember.wordId}"
                            name="details-btn"
                            data-plugin="contextmenu"
                            data-contextmenu:compare="Ava uues paneelis"
                            data-behaviour="replace">
                            <span th:text="${collocMember.word}"></span>
                            <code>
                              [<span th:text="${collocMember.weight}"></span>]
                            </code>
                          </button>
                          <br th:unless="${collocMemberIter.last}"/>
                        </span>
                      </td>
                      <td>
                        <span th:if="${colloc.definition != null}">
                          (<span th:text="${colloc.definition}"></span>)
                        </span>
                      </td>
                      <td>
                        <span th:text="${colloc.frequency}"></span>
                      </td>
                      <td>
                        <span th:text="${colloc.score}"></span>
                      </td>
                      <td>
                        <div th:if="${not #lists.isEmpty(colloc.collocUsages)}">
                          <div th:each="collocUsage : ${colloc.collocUsages}">
                            <i><span th:text="${collocUsage}"></span></i>
                          </div>
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </th:block>
            </div>
          </th:block>
        </div>
        <div class="pt-2" th:if="${not #lists.isEmpty(lexeme.secondaryCollocations)}">
          <span class="lbl">Kasutatud kollokatsioonides</span>
          <div class="border rounded p-2">
            <table class="with-horizontal-padding">
              <tr th:each="colloc : ${lexeme.secondaryCollocations}">
                <td>
                  <span th:text="${colloc.value}"></span>
                </td>
                <td>
                  <span th:each="collocMember,collocMemberIter : ${colloc.collocMembers}">
                    <button
                      type="button"
                      class="btn btn-link"
                      th:data-id="${collocMember.wordId}"
                      name="details-btn"
                      data-plugin="contextmenu"
                      data-contextmenu:compare="Ava uues paneelis"
                      data-behaviour="replace">
                      <span th:text="${collocMember.word}"></span>
                      <code>
                        [<span th:text="${collocMember.weight}"></span>]
                      </code>
                    </button>
                    <br th:unless="${collocMemberIter.last}"/>
                  </span>
                </td>
                <td>
                  <span th:if="${colloc.definition != null}">
                    (<span th:text="${colloc.definition}"></span>)
                  </span>
                </td>
                <td>
                  <span th:text="${colloc.frequency}"></span>
                </td>
                <td>
                  <span th:text="${colloc.score}"></span>
                </td>
                <td>
                  <div th:if="${not #lists.isEmpty(colloc.collocUsages)}">
                    <div th:each="collocUsage : ${colloc.collocUsages}">
                      <i><span th:text="${collocUsage}"></span></i>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <script th:replace="common :: confirmations"></script>
      <script>
        $('[data-toggle=deleteLexemeAndWordAndMeaning]').confirmation({
          btnOkLabel : 'Jah',
          btnCancelLabel : 'Ei',
          title : 'Kinnita kustutamine',
          onConfirm : deleteLexemeAndWordAndMeaning
        });
        $('[data-toggle=deleteLexemeAndRusMeaningLexemes]').confirmation({
          btnOkLabel : 'Jah',
          btnCancelLabel : 'Ei',
          title : 'Kinnita kustutamine',
          onConfirm : deleteLexemeAndRusMeaningLexemes
        });
      </script>
    </div>
  </th:block>
</body>
</html>
